<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>How the Library Works</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta name="save" content="history" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoad();" onmousedown="onBodyMouseDown();">
<div id="persistenceDiv" style="display:none; behavior:url(#default#userData);"></div>

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="24419.html">System Service Libraries Help</a> &gt; <a href="27082.html">Timer System Service Library</a> &gt; <a href="24443.html">Using the Library</a> &gt; <a href="24430.html">How the Library Works</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony Help</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="24433.html">Previous</a> | <a href="24443.html">Up</a> | <a href="24438.html">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: SYSTEM TMR How the Library Works Topic Title: How the Library Works)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table><div class="Element5">
How the Library Works</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
The following model gives information on interaction between various modules.&nbsp;</p>
<p class="Element10">
<img src="Client_Usage.png" border="0" alt="" title=""> &nbsp;</p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table0">
<tr>
<td class="Element67" valign="top" width="10%" style="border:none;">
<div class="Element68">
<img src="Note Icon.png" border="0" alt="" title=""> <strong>Note:</strong>&nbsp;</div></td><td class="Element67" valign="top" width="90%" style="border:none;">
<div class="Element68">
The arrows in the diagram indicate the dependencies or support.&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
Module interaction occurs in the following order:
<ol class="Element630">
<li value="1" class="Element600">The initialization, reinitialization, deinitialization are handled by the SYS INIT module.</li>
<li value="2" class="Element600">The Timer System Service Initialization function initializes the library's internal data structures.</li>
<li value="3" class="Element600">After the initialization, Timer System Service Tasks function would be called by the SYS Tasks module to open the Timer Driver and do other configuration activities. Once the Timer driver is ready to be used the Timer System Service Tasks API makes the system ready to be used by setting the status of the Timer System Service module to SYS_STATUS_READY.</li>
<li value="4" class="Element600">The application can now enable either periodic callback or one-shot callback or enable delays.</li>
</ol></p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table0">
<tr>
<td class="Element67" valign="top" width="10%" style="border:none;">
<div class="Element68">
<img src="Note Icon.png" border="0" alt="" title=""> <strong>Notes:</strong>&nbsp;</div></td><td class="Element67" valign="top" width="90%" style="border:none;">
<div class="Element68">

<ol class="Element630">
<li value="1" class="Element600">It is possible to have multiple clients access the system timer service, each with different periodic or single callbacks or delays.</li>
<li value="2" class="Element600">If the underlying Timer Driver uses Interrupt mode, it is the responsibility of the user or the application to ensure that the Interrupt system module has been initialized and that priorities have been set accordingly.</li>
<li value="3" class="Element600">Ensure that the selected timer clock source is DRV_TMR_CLKSOURCE_INTERNAL, as the Timer System Service will not function if the timer clock source is external.</li>
</ol>&nbsp;</div></td></tr></table></div></div>
</div>
</div>
<a name="546F70696373"></a><div class="Element14">
Topics</div>
<div class="Element11">
<div class="Element10">
<div class="Element212">
<div class="TableDiv">
<table cellspacing="0" class="Table1">
<tr>
<td class="Element200" valign="top" width="35%">
<div class="Element201">
Name&nbsp;</div></td><td class="Element204" valign="top" width="65%">
<div class="Element205">
Description&nbsp;</div></td></tr><tr>
<td class="Element202" valign="top" width="35%">
<div class="Element203">
<a href="24438.html">System Interaction</a>&nbsp;</div></td><td class="Element206" valign="top" width="65%">
<div class="Element207">
</p><p class="Element207" style="text-align: justify;">
<strong>Initialization and Reinitialization:</strong><br>The SYS module performs the initialization and the reinitialization of the Timer System Service. During initialization the following information is populated into the internal data structures from the init structure <a href="24172.html">SYS_TMR_INIT</a> passed as a parameter:</p><p class="Element207">
&nbsp;</div></td></tr><tr>
<td class="Element202" valign="top" width="35%">
<div class="Element203">
<a href="24437.html">Periodic Callback</a>&nbsp;</div></td><td class="Element206" valign="top" width="65%">
<div class="Element207">
This section describes the periodic callback registration and its usage.<br>The following diagram depicts the interaction across various modules for the periodic callback feature,<br><img src="Periodic.png" border="0" alt="" title=""><br><strong>Steps involved in registering and using the feature:</strong>
<ol class="Element630">
<li value="1" class="Element600">The Timer System Service should be in a ready state. Use the SYS_TMR_STATUS function to verify that the service is in this state.</li>
<li value="2" class="Element600">Register the periodic callback feature using the <a href="24154.html">SYS_TMR_CallbackPeriodic</a> function with the period, a context pointer, and the pointer to the callback routine. The interface <a href="24154.html">SYS_TMR_CallbackPeriodic</a> returns a valid handle after successful registration.</li>
</ol>&nbsp;</div></td></tr><tr>
<td class="Element202" valign="top" width="35%">
<div class="Element203">
<a href="24436.html">One Shot Callback</a>&nbsp;</div></td><td class="Element206" valign="top" width="65%">
<div class="Element207">
This section describes the one-shot/single callback registration and its usage.<br>The following diagram depicts the interaction across various modules for the one-shot callback feature,<br><img src="One Shot.png" border="0" alt="" title=""><br>Steps involved in registering and using the feature:
<ol class="Element630">
<li value="1" class="Element600">Initial requirement is to have the Timer System Service module in the SYS_STATUS_READY state. The user can call the function <a href="24185.html">SYS_TMR_Status</a> to get the current status information of the module.</li>
<li value="2" class="Element600">One-shot/Single callback feature can be registered by calling the function <a href="24155.html">SYS_TMR_CallbackSingle</a> with the parameters periodicity of the callback, a context pointer, and a pointer to the user's callback routine.</li>
</ol>Based on the periodicity set by the user, the... <a href="24436.html">more</a>&nbsp;</div></td></tr><tr>
<td class="Element202" valign="top" width="35%">
<div class="Element203">
<a href="24427.html">Delays</a>&nbsp;</div></td><td class="Element206" valign="top" width="65%">
<div class="Element207">
This section describes the delay registration and its usage. The mechanism depicted supports only non-blocking delays.<br>The following diagram depicts the interaction across various modules for the delay feature.<br><img src="Delay.png" border="0" alt="" title=""><br>Steps involved in registering and using the feature:
<ol class="Element630">
<li value="1" class="Element600">Initial requirement is to have the Timer System Service module in the SYS_STATUS_READY state. The user can call the function <a href="24185.html">SYS_TMR_Status</a> to get the current status information of the module.</li>
<li value="2" class="Element600">Delay feature can be registered by calling the function <a href="24160.html">SYS_TMR_DelayMS</a> with the delay parameter.</li>
</ol>&nbsp;</div></td></tr><tr>
<td class="Element202" valign="top" width="35%">
<div class="Element203">
<a href="24434.html">Miscellaneous</a>&nbsp;</div></td><td class="Element206" valign="top" width="65%">
<div class="Element207">
<strong>Tick Counts Information:</strong> The API <a href="24190.html">SYS_TMR_TickCountGet</a> provides the current tick information.&nbsp;</div></td></tr><tr>
<td class="Element202" valign="top" width="35%">
<div class="Element203">
<a href="24428.html">Examples</a>&nbsp;</div></td><td class="Element206" valign="top" width="65%">
<div class="Element207">
&nbsp;</div></td></tr></table></div></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="24419.html">System Service Libraries Help</a> &gt; <a href="27082.html">Timer System Service Library</a> &gt; <a href="24443.html">Using the Library</a> &gt; <a href="24430.html">How the Library Works</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
 MPLAB Harmony Help</div>
</td></tr><tr><td width="100%">
<div class="Element4">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td></tr><tr><td width="100%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: SYSTEM TMR How the Library Works Topic Title: How the Library Works)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>