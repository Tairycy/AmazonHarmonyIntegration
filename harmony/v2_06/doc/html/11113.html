<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>DRV_SST25VF020B_BlockWrite Function</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta name="save" content="history" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoad();" onmousedown="onBodyMouseDown();">
<div id="persistenceDiv" style="display:none; behavior:url(#default#userData);"></div>

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="13069.html">Driver Libraries Help</a> &gt; <a href="23142.html">SPI Flash Driver Library</a> &gt; <a href="08780.html">Library Interface</a> &gt; <a href="08786.html">SST25VF020B API</a> &gt; c) Block Operation Functions &gt; <a href="11113.html">DRV_SST25VF020B_BlockWrite Function</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony Help</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="11112.html">Previous</a> | <a href="08786.html">Up</a> | <a href="11110.html">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: DRV_SST25VF020B_BlockWrite@DRV_HANDLE@DRV_SST25VF020B_BLOCK_COMMAND_HANDLE *@uint8_t *@uint32_t@uint32_t Topic Title: DRV_SST25VF020B_BlockWrite Function)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table><div class="Element5">
DRV_SST25VF020B_BlockWrite Function</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<div class="Element58">
<a name="43"></a><div class="Element99">
C</div>
<div class="Element101"><div class="Element100"><pre class="Element100"><strong><span style="color: #000080">void</span></strong> <strong><span style="color: #000000">DRV_SST25VF020B_BlockWrite</span></strong>(
    <a href="10088.html">DRV_HANDLE</a> <strong><span style="color: #000000">handle</span></strong>, 
    <a href="11104.html">DRV_SST25VF020B_BLOCK_COMMAND_HANDLE</a> * <strong><span style="color: #000000">commandHandle</span></strong>, 
    uint8_t * <strong><span style="color: #000000">sourceBuffer</span></strong>, 
    uint32_t <strong><span style="color: #000000">blockStart</span></strong>, 
    uint32_t <strong><span style="color: #000000">nBlock</span></strong>
);</pre></div></div>
<a name="4465736372697074696F6E"></a><div class="Element14">
Description</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
This function schedules a non-blocking write operation for writing blocks of data into flash memory. The function returns with a valid buffer handle in the commandHandle argument if the write request was scheduled successfully. The function adds the request to the hardware instance queue and returns immediately. While the request is in the queue, the application buffer is owned by the driver and should not be modified. The function returns <a href="11105.html">DRV_SST25VF020B_BLOCK_COMMAND_HANDLE_INVALID</a> in the commandHandle argument under the following circumstances:
<ul class="Element636">
<li class="Element606">if a buffer could not be allocated to the request</li>
<li class="Element606">if the input buffer pointer is NULL</li>
<li class="Element606">if the client opened the driver for read only</li>
<li class="Element606">if the buffer size is 0 </li>
<li class="Element606">if the write queue size is full or queue depth is insufficient</li>
<li class="Element606">if the driver handle is invalid </li>
</ul>If the requesting client registered an event callback with the driver, the driver will issue a DRV_SST25VF020B_EVENT_BLOCK_COMMAND_COMPLETE event if the buffer was processed successfully or DRV_SST25VF020B_EVENT_BLOCK_COMMAND_ERROR event if the buffer was not processed successfully.</p></div>
</div>
<a name="507265636F6E646974696F6E73"></a><div class="Element14">
Preconditions</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
The <a href="11146.html">DRV_SST25VF020B_Initialize</a> function must have been called for the specified SPI Flash driver instance.&nbsp;</p>
<p class="Element10">
<a href="11150.html">DRV_SST25VF020B_Open</a> must have been called to obtain a valid opened device handle.&nbsp;</p>
<p class="Element10">
DRV_IO_INTENT_WRITE or DRV_IO_INTENT_READWRITE must have been specified in the <a href="11150.html">DRV_SST25VF020B_Open</a> call.&nbsp;</p>
<p class="Element10">
The flash address location which has to be written, must be erased before using the API <a href="11109.html">DRV_SST25VF020B_BlockErase</a>().</p></div>
</div>
<a name="506172616D6574657273"></a><div class="Element14">
Parameters</div>
<div class="Element11">
<div class="Element10">
<div class="Element312">
<div class="TableDiv">
<table cellspacing="0" class="Table4">
<tr>
<td class="Element300" valign="top" width="35%">
<div class="Element301">
Parameters&nbsp;</div></td><td class="Element304" valign="top" width="65%">
<div class="Element305">
Description&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
handle&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
A valid open-instance handle, returned from the driver's open function<br>commandHandle -Pointer to an argument that will contain the return buffer handle<br>&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
sourceBuffer&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
The source buffer containing data to be programmed into SPI Flash<br>&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
blockStart&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
Start block address of SST25VF020B Flash where the write should begin. It can be any address of the flash.&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
nBlock&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
Total number of blocks to be written. Each write block is of 1 byte.&nbsp;</div></td></tr></table></div></div>
</div>
</div>
<a name="52657475726E73"></a><div class="Element14">
Returns</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
The buffer handle is returned in the commandHandle argument. It will be DRV_BUFFER_HANDLE_INVALID if the request was not successful.</p></div>
</div>
<a name="52656D61726B73"></a><div class="Element14">
Remarks</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
In the case of multi bytes write operation, byte by byte writing will happen instead of Address auto Increment writing.&nbsp;</p>
<p class="Element10">
Write Protection will be disabled for the complete flash memory region in the beginning by default.</p></div>
</div>
<a name="4578616D706C65"></a><div class="Element14">
Example</div>
<div class="Element11">
<div class="Element10">
<div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code00806');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00806"><pre class="Element12">
uint8_t myBuffer[MY_BUFFER_SIZE];

<i><span style="color: #008000">// address should be block aligned.</span></i>
uint32_t blockStart = SST25VF020B_BASE_ADDRESS_TO_WRITE_TO;
uint32_t    nBlock = 2;
<a href="11104.html">DRV_SST25VF020B_BLOCK_COMMAND_HANDLE</a> commandHandle;
MY_APP_OBJ myAppObj;    

<i><span style="color: #008000">// mySST25VF020BHandle is the handle returned </span></i>
<i><span style="color: #008000">// by the DRV_SST25VF020B_Open function.</span></i>

<i><span style="color: #008000">// Client registers an event handler with driver</span></i>

<a href="11111.html">DRV_SST25VF020B_BlockEventHandlerSet</a>(mySST25VF020BHandle, 
                APP_SST25VF020BEventHandler, (uintptr_t)&amp;myAppObj);

DRV_SST25VF020B_BlockWrite( mySST25VF020BHandle, commandHandle,
                                        &amp;myBuffer, blockStart, nBlock );

<strong><span style="color: #000080">if</span></strong>(<a href="11105.html">DRV_SST25VF020B_BLOCK_COMMAND_HANDLE_INVALID</a> == commandHandle)
{
    <i><span style="color: #008000">// Error handling here</span></i>
}

<i><span style="color: #008000">// Event is received when</span></i>
<i><span style="color: #008000">// the buffer is processed.</span></i>

<strong><span style="color: #000080">void</span></strong> APP_SST25VF020BEventHandler(<a href="11106.html">DRV_SST25VF020B_BLOCK_EVENT</a> event, 
        <a href="11104.html">DRV_SST25VF020B_BLOCK_COMMAND_HANDLE</a> commandHandle, uintptr_t contextHandle)
{
    <i><span style="color: #008000">// contextHandle points to myAppObj.</span></i>

    <strong><span style="color: #000080">switch</span></strong>(event)
    {
        <strong><span style="color: #000080">case</span></strong> DRV_SST25VF020B_EVENT_BLOCK_COMMAND_COMPLETE:

            <i><span style="color: #008000">// This means the data was transferred. </span></i>
            <strong><span style="color: #000080">break</span></strong>;
        
        <strong><span style="color: #000080">case</span></strong> DRV_SST25VF020B_EVENT_BLOCK_COMMAND_ERROR:

            <i><span style="color: #008000">// Error handling here.</span></i>

            <strong><span style="color: #000080">break</span></strong>;

        <strong><span style="color: #000080">default</span></strong>:
            <strong><span style="color: #000080">break</span></strong>;
    }
}
</pre></div></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="13069.html">Driver Libraries Help</a> &gt; <a href="23142.html">SPI Flash Driver Library</a> &gt; <a href="08780.html">Library Interface</a> &gt; <a href="08786.html">SST25VF020B API</a> &gt; c) Block Operation Functions &gt; <a href="11113.html">DRV_SST25VF020B_BlockWrite Function</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
 MPLAB Harmony Help</div>
</td></tr><tr><td width="100%">
<div class="Element4">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td></tr><tr><td width="100%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: DRV_SST25VF020B_BlockWrite@DRV_HANDLE@DRV_SST25VF020B_BLOCK_COMMAND_HANDLE *@uint8_t *@uint32_t@uint32_t Topic Title: DRV_SST25VF020B_BlockWrite Function)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>