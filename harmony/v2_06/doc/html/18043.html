<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PIO Mode</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta name="save" content="history" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoad();" onmousedown="onBodyMouseDown();">
<div id="persistenceDiv" style="display:none; behavior:url(#default#userData);"></div>

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="17367.html">Peripheral Libraries Help</a> &gt; <a href="23263.html">SQI Peripheral Library</a> &gt; <a href="18045.html">Using the Library</a> &gt; <a href="18036.html">How the Library Works</a> &gt; <a href="18027.html">Core Functionality</a> &gt; <a href="18043.html">PIO Mode</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony Help</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="18032.html">Previous</a> | <a href="18027.html">Up</a> | <a href="18026.html">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: PLIB SQI PIO Mode Topic Title: PIO Mode)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table><div class="Element5">
PIO Mode</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
PIO mode is mostly used for data transfers. In PIO mode, the SQI module is entirely under the control of host processor. For the SQI module to operate in PIO mode, the host processor would have to set up the configuration, control, and clock control SFRs. Once the transactions are in progress, the host processor can use interrupts and status flags to control the operation. Please refer to the specific device data sheet and family reference manual for the configuration details.&nbsp;</p>
<p class="Element10">
The following figure shows the PIO mode software flow. </p><p class="Element10" style="text-align: center;">
<img src="pio_mode_flow.png" border="0" alt="" title=""></p><p class="Element10">
<strong>Example:</strong> </p><div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code03342');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code03342"><pre class="Element12"><i><span style="color: #008000">// Example is written to access SST26VF032 Flash device</span></i>
<i><span style="color: #008000">// Example assumes the Flash Device is connected to Chip Select 0</span></i>
<i><span style="color: #008000">// Example reads the device ID of the SST26VF032</span></i>

<i><span style="color: #008000">//Global defines</span></i>
<strong><span style="color: #000080">#define</span></strong> FALSE                0
<strong><span style="color: #000080">#define</span></strong> TRUE                 1
<strong><span style="color: #000080">#define</span></strong> SST26VF_EQIO         0x38
<strong><span style="color: #000080">#define</span></strong> SST26VF_HS_READ      0x0B
<strong><span style="color: #000080">#define</span></strong> SST26VF_QJEDID_READ  0x9F
<strong><span style="color: #000080">#define</span></strong> SST26VF_JEDEC_ID     0xBF2602

{
int32_t jedecID;

<i><span style="color: #008000">// Set up SQI Configuration (SQI1CFG) Register</span></i>
PLIB_SQI_ConfigWordSet(MY_SQI_INSTANCE,
                       1,
                       SQI_CS_OEN_0,
                       SQI_DATA_OEN_QUAD,
                       0,
                       1,
                       0,
                       0,
                       0,
                       SQI_DATA_FORMAT_MSBF,
                       SQI_DATA_MODE_3,
                       SQI_XFER_MODE_PIO
                       );

PLIB_SQI_ControlBufferThresholdSet(SQI_ID_1,4);

<i><span style="color: #008000">// Enable Specific Interrupts</span></i>
PLIB_SQI_InterruptEnable(SQI_ID_1,TXEMPTY|RXFULL/TXTHRIE|RXTHRIE);

<i><span style="color: #008000">// Set up SQI Transfer Clock</span></i>
PLIB_SQI_ClockDividerSet(SQI_ID_1,CLK_DIV_1);
PLIB_SQI_ClockEnable(SQI_ID_1);
<strong><span style="color: #000080">while</span></strong> (!PLIB_SQI_ClockIsStable(SQI_ID_1));

<i><span style="color: #008000">// Set up SQI Transmit Command Threshold</span></i>
PLIB_SQI_TxCommandThresholdSet(SQI_ID_1,3);

<i><span style="color: #008000">// Set up SQI Receive Buffer Threshold</span></i>
PLIB_SQI_TxBufferThresholdIntSet(SQI_ID_1,3);

<i><span style="color: #008000">// Configure SQI Control Fields and Send EQIO(0x38) Command to</span></i>
<i><span style="color: #008000">// SST26VF032 to Enable Quad Lane Mode</span></i>
PLIB_SQI_ControlWordSet(MY_SQI_INSTANCE,
                        1,
                        SQI_CS_1,
                        SQI_LANE_SINGLE,
                        SQI_CMD_TRANSMIT,
                        1
                        );
PLIB_SQI_ControlWordSet(MY_SQI_INSTANCE,
                        0,
                        SQI_CS_1,
                        SQI_LANE_QUAD,
                        SQI_CMD_TRANSMIT,
                        1
                        );
PLIB_SQI_ControlWordSet(MY_SQI_INSTANCE,
                        0,
                        SQI_CS_1,
                        SQI_LANE_QUAD,
                        SQI_CMD_RECEIVE,
                        3
                        );
<strong><span style="color: #000080">if</span></strong> ( PLIB_SQI_InterruptFlagGet(SQI_ID_1,TXEMPTY) )
   PLIB_SQI_TransmitData(SQI_ID_1, SST26VF_EQIO);

<i><span style="color: #008000">//Configure SQI to read JEDEC-ID in Quad Mode</span></i>
<strong><span style="color: #000080">if</span></strong> ( PLIB_SQI_InterruptFlagGet(SQI_ID_1,TXEMPTY) )
   PLIB_SQI_TransmitData(SQI_ID_1, SST26VF_QJEDID_READ);

<strong><span style="color: #000080">if</span></strong> (PLIB_SQI_InterruptFlagGet(SQI_ID_1,RXFULL))
   jedecID = PLIB_SQI_ReceiveData(SQI_ID_1);

<strong><span style="color: #000080">if</span></strong> (jedecID == SST26VF_JEDEC_ID)
<strong><span style="color: #000080">return</span></strong> TRUE;
<strong><span style="color: #000080">else</span></strong>
<strong><span style="color: #000080">return</span></strong> FALSE;
}</pre></div></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="17367.html">Peripheral Libraries Help</a> &gt; <a href="23263.html">SQI Peripheral Library</a> &gt; <a href="18045.html">Using the Library</a> &gt; <a href="18036.html">How the Library Works</a> &gt; <a href="18027.html">Core Functionality</a> &gt; <a href="18043.html">PIO Mode</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
 MPLAB Harmony Help</div>
</td></tr><tr><td width="100%">
<div class="Element4">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td></tr><tr><td width="100%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: PLIB SQI PIO Mode Topic Title: PIO Mode)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>