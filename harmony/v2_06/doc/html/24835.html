<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>SMTP Client Short Message Example</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta name="save" content="history" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoad();" onmousedown="onBodyMouseDown();">
<div id="persistenceDiv" style="display:none; behavior:url(#default#userData);"></div>

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="24489.html">TCP/IP Stack Libraries Help</a> &gt; <a href="22971.html">SMTP Module</a> &gt; <a href="24836.html">Using the Library</a> &gt; <a href="24833.html">SMTP Client Examples</a> &gt; <a href="24835.html">SMTP Client Short Message Example</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony Help</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="24833.html">Previous</a> | <a href="24833.html">Up</a> | <a href="24834.html">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: TCPIP SMTP SMTP Client Short Message Example Topic Title: SMTP Client Short Message Example)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table><div class="Element5">
SMTP Client Short Message Example</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
The SMTP client API is simplified when messages can be buffered entirely in RAM. The SMTPDemo example provided in <span class="Element146">MainDemo.c</span> sends a brief e-mail message indicating the current status of the board's buttons. This document will walk through that example.&nbsp;</p>
<p class="Element10">
Make sure STACK_USE_SMTP_CLIENT is uncommented in <span class="Element146">tcpip_config.h</span> before continuing.&nbsp;</p>
<p class="Element10">
The following diagram provides an overview of the process:&nbsp;</p>
<p class="Element10">
<img src="smtp_diagram.png" border="0" alt="" title="">
<ol class="Element630">
<li value="1" class="Element600">First, call SMTPBeginUsage to verify that the SMTP client is available and to begin a new message. If <a href="12128.html">FALSE</a> is returned, the SMTP client is busy and the application must return to the main loop to allow StackTask to execute again.</li>
<li value="2" class="Element600">Next, set the local relay server to use as SMTPClient.Server. If the local relay server requires a user name and password, set SMTPClient.Username and SMTPClient.Password to the appropriate credentials. If server parameters are not set, the stack will attempt to deliver the message directly to its destination host. This will likely fail due to SPAM prevention measures put in place by most ISPs and network administrators.</li>
<li value="3" class="Element600">Continue on to set the header strings as necessary for the message. This includes the subject line, from address, and any recipients you need to add. Finally, set SMTPClient.Body to the message to be sent.</li>
<li value="4" class="Element600">At this point, verify that SMTPClient.ROMPointers is correctly configured for any strings that are stored in program memory. Once the message is ready to send, call SMTPSendMail to instruct the SMTP client to begin transmission.</li>
<li value="5" class="Element600">The application must now call SMTPIsBusy until it returns <a href="12128.html">FALSE</a>. Each time <a href="27119.html">TRUE</a> is returned, return to the main loop and wait for StackTask to execute again. This allows the SMTP server to continue its work in a cooperative multitasking manner. Once <a href="12128.html">FALSE</a> is returned, call SMTPEndUsage to release the SMTP client. Check the return value of this function to determine if the message was successfully sent.</li>
</ol>The example in <span class="Element146">MainDemo.c</span> needs minor modifications to use your e-mail address. The Server and To fields must be set in SMTPDemo in order for the message to be properly delivered. Once this is done, holding down BUTTON2 and BUTTON3 simultaneously (the left-most two buttons) will begin sending the message. LED1 will light as the message is being processed, and will extinguish when the SMTP state machine completes. If the transmission was successful LED2 will light, otherwise it will remain dark.&nbsp;</p></div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="24489.html">TCP/IP Stack Libraries Help</a> &gt; <a href="22971.html">SMTP Module</a> &gt; <a href="24836.html">Using the Library</a> &gt; <a href="24833.html">SMTP Client Examples</a> &gt; <a href="24835.html">SMTP Client Short Message Example</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
 MPLAB Harmony Help</div>
</td></tr><tr><td width="100%">
<div class="Element4">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td></tr><tr><td width="100%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: TCPIP SMTP SMTP Client Short Message Example Topic Title: SMTP Client Short Message Example)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>