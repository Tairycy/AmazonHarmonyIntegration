<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>DRV_I2C_BufferEventHandlerSet Function</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta name="save" content="history" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoad();" onmousedown="onBodyMouseDown();">
<div id="persistenceDiv" style="display:none; behavior:url(#default#userData);"></div>

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="13069.html">Driver Libraries Help</a> &gt; <a href="13729.html">I2C Driver Library Help</a> &gt; <a href="08587.html">Library Interface</a> &gt; c) Data Transfer Functions &gt; <a href="10094.html">DRV_I2C_BufferEventHandlerSet Function</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony Help</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="10114.html">Previous</a> | <a href="08587.html">Up</a> | <a href="10095.html">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: DRV_I2C_BufferEventHandlerSet@DRV_HANDLE@DRV_I2C_BUFFER_EVENT_HANDLER@uintptr_t Topic Title: DRV_I2C_BufferEventHandlerSet Function)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table><div class="Element5">
DRV_I2C_BufferEventHandlerSet Function</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<div class="Element58">
<a name="43"></a><div class="Element99">
C</div>
<div class="Element101"><div class="Element100"><pre class="Element100"><strong><span style="color: #000080">void</span></strong> <strong><span style="color: #000000">DRV_I2C_BufferEventHandlerSet</span></strong>(
    <strong><span style="color: #000080">const</span></strong> <a href="10088.html">DRV_HANDLE</a> <strong><span style="color: #000000">handle</span></strong>, 
    <strong><span style="color: #000080">const</span></strong> DRV_I2C_BUFFER_EVENT_HANDLER <strong><span style="color: #000000">eventHandler</span></strong>, 
    <strong><span style="color: #000080">const</span></strong> uintptr_t <strong><span style="color: #000000">context</span></strong>
);</pre></div></div>
<a name="4465736372697074696F6E"></a><div class="Element14">
Description</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
This function allows a client to identify a buffer event handling function for the driver to call back when a queued buffer transfer has finished. When a client calls either the <a href="10117.html">DRV_I2C_Receive</a>, <a href="10122.html">DRV_I2C_Transmit</a> or DRV_I2C_TransmiThenReceive function, it is provided with a handle identifying the buffer that was added to the driver's buffer queue. The driver will pass this handle back to the client by calling &quot;eventHandler&quot; function when the buffer transfer has completed.&nbsp;</p>
<p class="Element10">
The event handler should be set before the client performs any transmision or reception operations that could generate events. The event handler once set, persists until the client closes the driver or sets another event handler (which could be a &quot;NULL&quot; pointer to indicate no callback).&nbsp;</p>
<p class="Element10">
When in Master mode, a callback event is registered to let the application know that the buffer has been transmitted. DRV_I2C_BUFFER_EVENT_COMPLETE is set when the buffer has been transmitted without any errors. DRV_I2C_BUFFER_EVENT_ERROR is set when buffer transmission or reception has been aborted.&nbsp;</p>
<p class="Element10">
When in Slave mode, since the Master controls when a transmit or receive operation is terminated, a callback is registered every time a byte is written or read from the slave.</p></div>
</div>
<a name="507265636F6E646974696F6E73"></a><div class="Element14">
Preconditions</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
The <a href="10111.html">DRV_I2C_Initialize</a> routine must have been called for the specified I2C driver instance.&nbsp;</p>
<p class="Element10">
<a href="10114.html">DRV_I2C_Open</a> must have been called to obtain a valid opened device handle.&nbsp;</p></div>
</div>
<a name="506172616D6574657273"></a><div class="Element14">
Parameters</div>
<div class="Element11">
<div class="Element10">
<div class="Element312">
<div class="TableDiv">
<table cellspacing="0" class="Table4">
<tr>
<td class="Element300" valign="top" width="35%">
<div class="Element301">
Parameters&nbsp;</div></td><td class="Element304" valign="top" width="65%">
<div class="Element305">
Description&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
handle&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
A valid open-instance handle, returned from the driver's open routine<br>&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
eventHandler&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
Pointer to the event handler function.<br>&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
context&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
The value of parameter will be passed back to the client unchanged, when the eventHandler function is called. It can be used to identify any client specific data object that identifies the instance of the client module (for example, it may be a pointer to the client module's state structure).&nbsp;</div></td></tr></table></div></div>
</div>
</div>
<a name="52657475726E73"></a><div class="Element14">
Returns</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
None.</p></div>
</div>
<a name="52656D61726B73"></a><div class="Element14">
Remarks</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
If the client does not want to be notified when the queued buffer transfer has completed, it does not need to register a callback. This function is thread safe when called in a RTOS application.</p></div>
</div>
<a name="4578616D706C65"></a><div class="Element14">
Example</div>
<div class="Element11">
<div class="Element10">
<div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code00633');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00633"><pre class="Element12"><strong><span style="color: #000080">#define</span></strong> MY_BUFFER_SIZE  10

<i><span style="color: #008000">// function prototype of Event Handler Function</span></i>
<strong><span style="color: #000080">void</span></strong> APP_I2CBufferEventFunction ( DRV_I2C_BUFFER_EVENT event,
                                  DRV_I2C_BUFFER_HANDLE bufferHandle,
                                  uintptr_t context );

<i><span style="color: #008000">//Returned from DRV_I2C_Open</span></i>
<a href="10088.html">DRV_HANDLE</a> drvI2Chandle;

<i><span style="color: #008000">// myAppObj is an application specific state data object.</span></i>
DRV_I2C_BUFFER_EVENT operationStatus;

uint8_t appBuffer[MY_BUFFER_SIZE];

DRV_I2C_BUFFER_HANDLE drvI2CRDBUFHandle

<i><span style="color: #008000">// Opens an instance of I2C driver</span></i>
drvI2Chandle = <a href="10114.html">DRV_I2C_Open</a>( DRV_I2C_INDEX_0,DRV_IO_INTENT_WRITE );

<i><span style="color: #008000">// Client registers an event handler with driver. This is done once.</span></i>
DRV_I2C_BufferEventHandlerSet( drvI2Chandle,
                               APP_I2CBufferEventFunction,
                               operationStatus );

drvI2CRDBUFHandle = <a href="10117.html">DRV_I2C_Receive</a> (   drvI2CHandle,
                                        slaveaddress
                                        &amp;appBuffer[],
                                        MY_BUFFER_SIZE,
                                        NULL );

<strong><span style="color: #000080">if</span></strong>(NULL == drvI2CRDBUFHandle)
{
    <i><span style="color: #008000">// Error handling here</span></i>
}

<i><span style="color: #008000">// Event Processing Technique. Event is received when</span></i>
<i><span style="color: #008000">// the buffer is processed.</span></i>

<strong><span style="color: #000080">void</span></strong> APP_I2CBufferEventFunction( DRV_I2C_BUFFER_EVENT event,
                                 DRV_I2C_BUFFER_HANDLE handle,
                                 uintptr_t context)
{

    <strong><span style="color: #000080">switch</span></strong>(event)
    {
        <strong><span style="color: #000080">case</span></strong> DRV_I2C_BUFFER_EVENT_COMPLETE:
            <i><span style="color: #008000">//perform appropriate action</span></i>
        <strong><span style="color: #000080">break</span></strong>;

        <strong><span style="color: #000080">case</span></strong> DRV_I2C_BUFFER_EVENT_ERROR:
            <i><span style="color: #008000">// Error handling here.</span></i>
        <strong><span style="color: #000080">break</span></strong>;

        <strong><span style="color: #000080">default</span></strong>:
            <strong><span style="color: #000080">break</span></strong>;
    }
}</pre></div></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="13069.html">Driver Libraries Help</a> &gt; <a href="13729.html">I2C Driver Library Help</a> &gt; <a href="08587.html">Library Interface</a> &gt; c) Data Transfer Functions &gt; <a href="10094.html">DRV_I2C_BufferEventHandlerSet Function</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
 MPLAB Harmony Help</div>
</td></tr><tr><td width="100%">
<div class="Element4">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td></tr><tr><td width="100%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: DRV_I2C_BufferEventHandlerSet@DRV_HANDLE@DRV_I2C_BUFFER_EVENT_HANDLER@uintptr_t Topic Title: DRV_I2C_BufferEventHandlerSet Function)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>