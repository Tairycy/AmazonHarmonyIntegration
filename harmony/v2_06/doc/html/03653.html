<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Running the Demonstration</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta name="save" content="history" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoad();" onmousedown="onBodyMouseDown();">
<div id="persistenceDiv" style="display:none; behavior:url(#default#userData);"></div>

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="04300.html">Volume I: Getting Started With MPLAB Harmony Libraries and Applications</a> &gt; <a href="03342.html">Applications Help</a> &gt; <a href="12132.html">File System Demonstrations</a> &gt; <a href="03638.html">Demonstrations</a> &gt; <a href="03650.html">sdcard_msd_fat_multi_disk</a> &gt; <a href="03653.html">Running the Demonstration</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony Help</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="03652.html">Previous</a> | <a href="03650.html">Up</a> | <a href="03654.html">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: APPS FS sdcard_msd_fat_multi_disk_run Topic Title: Running the Demonstration)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table><div class="Element5">
Running the Demonstration</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
This demonstration shows an example of:</p>
<ul class="Element630">
<li class="Element600">Implementing a FAT File System on a SD card and a USB Flash drive</li>
<li class="Element600">Opening a file for read or write</li>
<li class="Element600">Searching for a file</li>
<li class="Element600">Checking for end of the file</li>
<li class="Element600">Closing a file</li>
</ul><p class="Element10">
Do the following to run the demonstration:</p>
<ol class="Element630">
<li value="1" class="Element600">Select the desired MPLAB X IDE project configuration for the hardware in use.</li>
<li value="2" class="Element600">Copy the <span class="Element146">mchpLogo.bmp</span> file from <span class="Element146">&lt;install-dir&gt;/apps/fs/sdcard_msd_fat_multi_disk/firmware/src</span> to the USB Flash drive.</li>
<li value="3" class="Element600">Insert the SD card into the MEB II.</li>
<li value="4" class="Element600">Inset the USB Flash drive card into the starter kit.</li>
<li value="5" class="Element600">Compile the selected configuration in the MPLAB X IDE project and run the code.</li>
<li value="6" class="Element600">The demonstration searches for the <span class="Element146">mchpLogo.bmp</span> on the USB Flash drive and copies it from the USB Flash drive to the SD card. The Green LED indicates the file has been successfully copied from the USB Flash drive to SD card.</li>
<li value="7" class="Element600">Remove the SD card from the MEB II board and<span style="color: #FFFFFF">_</span>connect<span style="color: #FFFFFF">_</span>it to a personal computer to verify that the <span class="Element146">mchpLogo.bmp</span> file is available on SD card.</li>
</ol><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element65" valign="top" width="59%">
<div class="Element66">
Demonstration Board&nbsp;</div></td><td class="Element65" valign="top" width="21%">
<div class="Element66">
Demonstration Success&nbsp;</div></td><td class="Element65" valign="top" width="20%">
<div class="Element66">
Demonstration Failure&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="59%">
<div class="Element68">
PIC32MZ EC Starter Kit<br>PIC32MZ EF Starter Kit<br>PIC32MZ DA Starter Kit&nbsp;</div></td><td class="Element67" valign="top" width="21%">
<div class="Element68">
Green LED ON&nbsp;</div></td><td class="Element67" valign="top" width="20%">
<div class="Element68">
Red LED ON&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
This demonstration searches for a file using wildcard characters &quot;<span class="Element146">mch*.*</span>&quot;, reads the content of the file, and then writes the contents of the file to the SD card.&nbsp;</p>
<p class="Element10">
The demonstration application logic is implemented as a state machine in the APP_USB_MSDTasks and APP_SDCardTasks functions in the file <span class="Element146">app.c</span>.&nbsp;</p>
<p class="Element10">
The demonstration process is as follows:</p>
<ol class="Element630">
<li value="1" class="Element600">The SD card is mounted using the <a href="23902.html">SYS_FS_Mount</a> function. The <span class="Element146">/dev/mmcblka1</span> path instructs the mount function to mount a SD card volume. The volume is mounted with a FAT file system and mounted as <span class="Element146">/mnt/sdDrive/</span>.</li>
<li value="2" class="Element600">If the mount is successful, the SD card state machine waits until the USB Flash drive is connected and mounted.</li>
<li value="3" class="Element600">The USB MSD task function opens an instance of the USB Host stack and enables the USB Host operations before mounting the USB Flash drive.</li>
<li value="4" class="Element600">The USB Flash drive is mounted once it is connected using the <a href="23902.html">SYS_FS_Mount</a> function. The <span class="Element146">/dev/sda1</span> path instructs the mount function to mount a SD USB Flash drive volume. The volume is mounted with the FAT file system as <span class="Element146">/mnt/msdDrive/</span>.</li>
<li value="5" class="Element600">If the USB Flash drive is mounted successfully, the application opens the root directory on the USB Flash drive and searches for the file using the wildcard characters &quot;<span class="Element146">mch*.*</span>&quot; using <a href="23765.html">SYS_FS_DirSearch</a>.</li>
<li value="6" class="Element600">If the search operation is successful, the application opens the file in read mode using <a href="23836.html">SYS_FS_FileOpen</a>.</li>
<li value="7" class="Element600">If the file open is successful, the application sets the current working directory as <span class="Element146">sdDrive</span> using <a href="23757.html">SYS_FS_CurrentDriveSet</a> and creates a new file on the SD card in write mode. The name of the new file is the same as was returned from <a href="23765.html">SYS_FS_DirSearch</a>.</li>
<li value="8" class="Element600">If the file is created successfully, the application reads the data from the file on the USB Flash drive using <a href="23838.html">SYS_FS_FileRead</a> and writes it to the file on the SD card using <a href="23848.html">SYS_FS_FileWrite</a> until the end of file is reached.</li>
<li value="9" class="Element600">Once the end of the file is reached, both files are closed with the <a href="23828.html">SYS_FS_FileClose</a> function.</li>
<li value="10" class="Element600">Green LED indicates successful operation.</li>
</ol></div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="04300.html">Volume I: Getting Started With MPLAB Harmony Libraries and Applications</a> &gt; <a href="03342.html">Applications Help</a> &gt; <a href="12132.html">File System Demonstrations</a> &gt; <a href="03638.html">Demonstrations</a> &gt; <a href="03650.html">sdcard_msd_fat_multi_disk</a> &gt; <a href="03653.html">Running the Demonstration</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
 MPLAB Harmony Help</div>
</td></tr><tr><td width="100%">
<div class="Element4">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td></tr><tr><td width="100%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: APPS FS sdcard_msd_fat_multi_disk_run Topic Title: Running the Demonstration)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>