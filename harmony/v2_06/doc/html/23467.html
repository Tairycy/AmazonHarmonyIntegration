<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>USB-CDC Console Device</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta name="save" content="history" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoad();" onmousedown="onBodyMouseDown();">
<div id="persistenceDiv" style="display:none; behavior:url(#default#userData);"></div>

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="24419.html">System Service Libraries Help</a> &gt; <a href="07421.html">Console System Service Library</a> &gt; <a href="23469.html">Using the Library</a> &gt; <a href="23459.html">How the Library Works</a> &gt; <a href="23454.html">Console Device Modules</a> &gt; <a href="23467.html">USB-CDC Console Device</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony Help</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="23450.html">Previous</a> | <a href="23454.html">Up</a> | <a href="23465.html">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: SYS CONSOLE USB-CDC Console Device Topic Title: USB-CDC Console Device)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table><div class="Element5">
USB-CDC Console Device</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
In this implementation, the PIC32 acts as a USB device, communicating with a host PC running a terminal emulation program such as Tera Term. This provides a convenient interface for error or debug messages, or a means of communicating with a user interactively. The application does not use the USB-CDC APIs directly, instead all interaction is through the Console System service APIs.&nbsp;</p>
<p class="Element10">
The USB-CDC Console Device supports only non-blocking operation.&nbsp;</p>
<p class="Element10">
<strong>Read</strong>&nbsp;</p>
<p class="Element10">
While the user may request multiple bytes of data per read, a typical terminal emulator program sends only one byte per USB transaction. When multiple bytes are requested, the USB-CDC Console Device layer<span style="color: #FFFFFF">_</span>will queue individual byte reads until all bytes are read. The size of the read queue is a configuration option. The bytes are sent to the user-supplied read buffer as they are read, and the read callback is triggered when all bytes have been read. Only one read operation can be active at a time.&nbsp;</p>
<p class="Element10">
If the user requests more data bytes than the read queue will hold, the read function will queue and return the size of the read queue. In this scenario, the user can either do multiple reads until all the data is read, or configure the service to use a larger read queue.&nbsp;</p>
<p class="Element10">
The read function accepts a pointer to a read buffer as one of the arguments. It is the responsibility of the application programmer to properly allocate the read buffer.&nbsp;</p>
<p class="Element10">
<strong>Write</strong>&nbsp;</p>
<p class="Element10">
The USB-CDC console device is capable of writing multiple data bytes per USB transaction, and queuing multiple write transactions. The size of the write queue is a configuration option. If the user tries to queue more write transactions than the write queue can accommodate, the write function will return -1 and set the module status to SYS_STATUS_ERROR.&nbsp;</p>
<p class="Element10">
The write function accepts a pointer to a write buffer as one of the arguments. It is the responsibility of the application programmer to properly allocate the write buffer.&nbsp;</p>
<p class="Element10">
<strong>State Machine</strong>&nbsp;</p>
<p class="Element10">
The USB-CDC Console Device layer<span style="color: #FFFFFF">_</span>implements a state machine that is advanced by each call to the tasks routine. The Console System tasks routine is called periodically by the <a href="24151.html">SYS_Tasks</a> routine, which is called in a loop by main(). The state machine manages initialization of the Console Device, schedules reads and writes, and dispatches callback functions.&nbsp;</p>
<p class="Element10">
<strong>Register Callback</strong>&nbsp;</p>
<p class="Element10">
The callback registration mechanism associates a user function with a read or write completion event. The callback function includes an argument containing a pointer to the read or write buffer associated with the transfer that initiated the callback. Separate callback functions must be registered for read and write events. If there is no callback function registered, the event will complete as normal, with no callback executed.&nbsp;</p>
<p class="Element10">
<strong>Flush</strong>&nbsp;</p>
<p class="Element10">
The flush routine in the USB-CDC implementation clears any error conditions, terminates any read or write transactions, and resets the read and write queues. A flush operation is typically triggered in response to an error condition.</p></div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="24419.html">System Service Libraries Help</a> &gt; <a href="07421.html">Console System Service Library</a> &gt; <a href="23469.html">Using the Library</a> &gt; <a href="23459.html">How the Library Works</a> &gt; <a href="23454.html">Console Device Modules</a> &gt; <a href="23467.html">USB-CDC Console Device</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
 MPLAB Harmony Help</div>
</td></tr><tr><td width="100%">
<div class="Element4">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td></tr><tr><td width="100%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: SYS CONSOLE USB-CDC Console Device Topic Title: USB-CDC Console Device)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>