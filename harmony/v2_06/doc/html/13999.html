<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>How the Library Works</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta name="save" content="history" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoad();" onmousedown="onBodyMouseDown();">
<div id="persistenceDiv" style="display:none; behavior:url(#default#userData);"></div>

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="13069.html">Driver Libraries Help</a> &gt; <a href="13984.html">Input System Service Touch Driver Library</a> &gt; <a href="13993.html">Input System Service mXT336T Touch Driver Library</a> &gt; <a href="13999.html">How the Library Works</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony Help</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="13997.html">Previous</a> | <a href="13993.html">Up</a> | <a href="13995.html">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: Input_sys_serve_MXT_touch_lib_works Topic Title: How the Library Works)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table><div class="Element5">
How the Library Works</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
The library provides interfaces to support:
<ul class="Element635">
<li class="Element605">System functions, which provide system module interfaces, device initialization, deinitialization, open, close, task, and status functions.</li>
<li class="Element605">Read Request function, which provides Touch input data read request function.</li>
</ul></p><div class="Element15">
Initializing the Driver</div>
<p class="Element10">
Before the mXT336T Touch Driver can be opened, it must be configured and initialized. The driver build time configuration is defined by the configuration macros. Refer to the Building the Library section for the location of and more information on the various configuration macros and how these macros should be designed. The driver initialization is configured through the <a href="10542.html">DRV_MXT336T_INIT</a> data structure that is passed to the <a href="10551.html">DRV_MXT336T_Initialize</a> function. The initialization parameters include the interrupt source, interrupt pin remap configuration and touch screen resolution. The following code shows an example of initializing the mXT336T Touch Driver.&nbsp;</p>
<p class="Element10">
Example:&nbsp;</p>
<p class="Element10">
<span class="Element146">/* The following code shows an example of designing the</span>&nbsp;</p>
<p class="Element10">
<span class="Element146">* <a href="11375.html">DRV_TOUCH_INIT</a> data structure. It also shows how an example</span>&nbsp;</p>
<p class="Element10">
<span class="Element146">* usage of the DRV_TOUCH_MXT336T_Initialize function.</span>&nbsp;</p>
<p class="Element10">
<span class="Element146">*/</span>&nbsp;</p>
<p class="Element10">
<span class="Element146">This entire example section can be replaced with:</span>&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
<span class="Element146">const <a href="10542.html">DRV_MXT336T_INIT</a> drvMXT336TInitData =</span>&nbsp;</p>
<p class="Element10">
<span class="Element146">{</span>&nbsp;</p>
<p class="Element10">
<span class="Element146"> .drvOpen = <a href="10114.html">DRV_I2C_Open</a>,</span>&nbsp;</p>
<p class="Element10">
<span class="Element146"> .orientation = 0,</span>&nbsp;</p>
<p class="Element10">
<span class="Element146"> .horizontalResolution = 480,</span>&nbsp;</p>
<p class="Element10">
<span class="Element146"> .verticalResolution = 272,</span>&nbsp;</p>
<p class="Element10">
<span class="Element146"></span>&nbsp;</p>
<p class="Element10">
<span class="Element146">};</span>&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
<span class="Element146">sysObj.drvMXT336T = <a href="10551.html">DRV_MXT336T_Initialize</a>(0, (<a href="23969.html">SYS_MODULE_INIT</a> *)&amp;drvMXT336TInitData);</span>&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element15">
Touch Input Read Request</div>
<p class="Element10">
To read the touch input from the mXT336T touch controller device, a read request must be registered. This is done by calling <a href="10700.html">DRV_MXT336T_ReadRequest</a>. If successful, it registers a buffer read request to the I2C command queue. It also adds an input decode command to the mXT336T command queue once the I2C returns with touch input data. It can return error if the driver instance object is invalid or the mXT336T command queue is full. The read request is to be called from the mXT336T ISR. This ISR is triggered once the touch input is available.&nbsp;</p>
<p class="Element10">
The following code shows an example of a mXT336T read request registration:&nbsp;</p>
<p class="Element10">
<span class="Element146"><a href="23975.html">SYS_MODULE_OBJ</a> object; // Returned from DRV_TOUCH_MXT336T_Initialize</span>&nbsp;</p>
<p class="Element10">
<span class="Element146">void ISR(_EXTERNAL_INT_VECTOR, ipl5) _IntHandlerDrvMxt336t(void)</span>&nbsp;</p>
<p class="Element10">
<span class="Element146">{</span>&nbsp;</p>
<p class="Element10">
<span class="Element146"> DRV__MXT336T_ReadRequest ( object );</span>&nbsp;</p>
<p class="Element10">
<span class="Element146"> // Do Other Tasks</span>&nbsp;</p>
<p class="Element10">
<span class="Element146"> .</span>&nbsp;</p>
<p class="Element10">
<span class="Element146"> .</span>&nbsp;</p>
<p class="Element10">
<span class="Element146"> .</span>&nbsp;</p>
<p class="Element10">
<span class="Element146">}</span>&nbsp;</p>
<p class="Element10">
<strong>Tasks Routine</strong>&nbsp;</p>
<p class="Element10">
This routine processes the mXT336T commands from the command queue. If the state of the command is initialize or done it returns. If the read request registration is successful the state of command is to decode input. The tasks routine decodes the input and updates the global variables storing the touch input data in form of x and y coordinates. The mXT336T Touch Driver task routine is to be called from <a href="24151.html">SYS_Tasks</a>. The following code shows an example:&nbsp;</p>
<p class="Element10">
<span class="Element146"><a href="23975.html">SYS_MODULE_OBJ</a> drvMXT336T;</span>&nbsp;</p>
<p class="Element10">
<span class="Element146"><a href="23975.html">SYS_MODULE_OBJ</a> drvMxt0;; // Returned from DRV_TOUCH_MXT336T_Initialize</span>&nbsp;</p>
<p class="Element10">
<span class="Element146">void <a href="24151.html">SYS_Tasks</a>( void )</span>&nbsp;</p>
<p class="Element10">
<span class="Element146">{</span>&nbsp;</p>
<p class="Element10">
<span class="Element146"><a href="10705.html">DRV_MXT336T_Tasks</a>(sysObj.drvMXT336T);</span>&nbsp;</p>
<p class="Element10">
<span class="Element146"><a href="10518.html">DRV_MXT_Tasks</a>(sysObj.drvMxt0);</span>&nbsp;</p>
<p class="Element10">
<span class="Element146">// Do other tasks</span>&nbsp;</p>
<p class="Element10">
<span class="Element146">}</span>&nbsp;</p></div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="13069.html">Driver Libraries Help</a> &gt; <a href="13984.html">Input System Service Touch Driver Library</a> &gt; <a href="13993.html">Input System Service mXT336T Touch Driver Library</a> &gt; <a href="13999.html">How the Library Works</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
 MPLAB Harmony Help</div>
</td></tr><tr><td width="100%">
<div class="Element4">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td></tr><tr><td width="100%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: Input_sys_serve_MXT_touch_lib_works Topic Title: How the Library Works)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>