<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>System Access</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta name="save" content="history" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoad();" onmousedown="onBodyMouseDown();">
<div id="persistenceDiv" style="display:none; behavior:url(#default#userData);"></div>

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="13069.html">Driver Libraries Help</a> &gt; <a href="13058.html">Codec Driver Libraries</a> &gt; <a href="03266.html">AK4384 Codec Driver Library</a> &gt; <a href="08311.html">Using the Library</a> &gt; <a href="08304.html">How the Library Works</a> &gt; <a href="08309.html">System Access</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony Help</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="08304.html">Previous</a> | <a href="08304.html">Up</a> | <a href="08295.html">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: DRV AK4384 System Access Topic Title: System Access)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table><div class="Element5">
System Access</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
<strong>System Initialization</strong>&nbsp;</p>
<p class="Element10">
The system performs the initialization of the device driver with settings that affect only the instance of the device that is being initialized. During system initialization, each instance of the AK4384 module would be initialized with the following configuration settings (either passed dynamically at run time using <a href="09097.html">DRV_AK4384_INIT</a> or by using Initialization Overrides) that are supported by the specific AK4384 device hardware:
<ul class="Element635">
<li class="Element605">Device requested power state: one of the System Module Power States. For specific details please refer to <strong>Data Types and Constants</strong> in the <a href="08306.html">Library Interface</a> section.</li>
<li class="Element605">SPI driver module index. The module index should be same as the one used in initializing the SPI Driver.</li>
<li class="Element605">I2S driver module index. The module index should be same as the one used in initializing the I2S Driver.</li>
<li class="Element605">Sampling rate</li>
<li class="Element605">Master clock detection mode</li>
<li class="Element605">Power down pin port initialization</li>
<li class="Element605">Queue size for the audio data transmit buffer</li>
</ul>The <a href="09104.html">DRV_AK4384_Initialize</a> API returns an object handle of the type <a href="23975.html">SYS_MODULE_OBJ</a>. The object handle returned by the Initialize interface would be used by the other system interfaces such as DRV_ AK4384_Deinitialize, DRV_ AK4384_Status and <a href="10222.html">DRV_I2S_Tasks</a>.</p><div class="Element15">
Implementations</div>
<p class="Element10">
The AK4384 Codec Driver can have the following implementations: </p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element65" valign="top" width="10%">
<div class="Element66">
Implementation&nbsp;</div></td><td class="Element65" valign="top" width="37%">
<div class="Element66">
Description&nbsp;</div></td><td class="Element65" valign="top" width="53%">
<div class="Element66">
MPLAB Harmony Components&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="10%">
<div class="Element68">
Implementation 1&nbsp;</div></td><td class="Element67" valign="top" width="37%">
<div class="Element68">
Dedicated hardware for control (SPI) and data (I2S) interface.&nbsp;</div></td><td class="Element67" valign="top" width="53%">
<div class="Element68">
Standard MPLAB Harmony drivers for SPI and I2S interfaces.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="10%">
<div class="Element68">
Implementation 2&nbsp;</div></td><td class="Element67" valign="top" width="37%">
<div class="Element68">
Dedicated hardware for data (I2S) interface.<br>Ports pins for control interface.&nbsp;</div></td><td class="Element67" valign="top" width="53%">
<div class="Element68">
Standard MPLAB Harmony drivers for I2S interface.<br>Virtual MPLAB Harmony drivers for SPI interface.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="10%">
<div class="Element68">
Implementation 3&nbsp;</div></td><td class="Element67" valign="top" width="37%">
<div class="Element68">
Dedicated hardware for data (I2S) interface.<br>Ports pins for control.&nbsp;</div></td><td class="Element67" valign="top" width="53%">
<div class="Element68">
Standard MPLAB Harmony drivers for I2S interface.<br>An internal bit-banged implementation of control interface in the AK4384 Codec Driver.&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
If Implementation 3 is in use, while initializing fields of <a href="09097.html">DRV_AK4384_INIT</a> structure, the SPI Driver module index initialization is redundant. The user can pass a dummy value.&nbsp;</p>
<p class="Element10">
For Implementation 3, the user has to additionally initialize parameters to support bit-banged control interface implementation. These additional parameters can be passed by assigning values to the respective macros in <span class="Element146">system_config.h</span>.&nbsp;</p>
<p class="Element10">
<strong>Example:</strong> &nbsp;</p><div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code00377');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00377"><pre class="Element12">DRV_AK4384_INIT drvak4384Init =
{
    .moduleInit.value = SYS_MODULE_POWER_RUN_FULL,
    .volume = 120,
    .mclkMode = DRV_AK4384_MCLK_MODE_MANUAL,
    .queueSizeTransmit = 2,
};

<i><span style="color: #008000">/*
 The SPI module index should be same as the one used in
 initializing the SPI driver.
 The SPI module index initialization is redundant
 if Implementation 3 is in use.
 */</span></i>
drvak4384Init.spiDriverModuleIndex = DRV_SPI_INDEX_0;

<i><span style="color: #008000">/*
 The I2S module index should be same as the one used in
 initializing the I2S driver.
 */</span></i>
drvak4384Init.i2sDriverModuleIndex = DRV_I2S_INDEX_0;

ak4384DevObject = DRV_AK4384_Initialize(DRV_AK4384_INDEX_0, (SYS_MODULE_INIT *) &amp;drvak4384Init);
<strong><span style="color: #000080">if</span></strong> (SYS_MODULE_OBJ_INVALID == ak4384DevObject)
{
    <i><span style="color: #008000">// Handle error</span></i>
}</pre></div></div>
<div class="Element15">
Task Routine</div>
<p class="Element10">
The <a href="09120.html">DRV_AK4384_Tasks</a> will be called from the System Task Service.</p></div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="13069.html">Driver Libraries Help</a> &gt; <a href="13058.html">Codec Driver Libraries</a> &gt; <a href="03266.html">AK4384 Codec Driver Library</a> &gt; <a href="08311.html">Using the Library</a> &gt; <a href="08304.html">How the Library Works</a> &gt; <a href="08309.html">System Access</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
 MPLAB Harmony Help</div>
</td></tr><tr><td width="100%">
<div class="Element4">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td></tr><tr><td width="100%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: DRV AK4384 System Access Topic Title: System Access)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>