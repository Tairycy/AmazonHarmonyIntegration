<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>File System Read/Write</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta name="save" content="history" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoad();" onmousedown="onBodyMouseDown();">
<div id="persistenceDiv" style="display:none; behavior:url(#default#userData);"></div>

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="13064.html">Volume IV: MPLAB Harmony Development</a> &gt; <a href="16810.html">MPLAB Harmony Driver Development Guide</a> &gt; <a href="11772.html">Client Interface</a> &gt; <a href="11774.html">Common Data Transfer Models</a> &gt; <a href="11779.html">File System Read/Write</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony Help</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="11769.html">Previous</a> | <a href="11774.html">Up</a> | <a href="11768.html">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: DRVDEVGUIDE File System Read_Write Topic Title: File System Read/Write)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table><div class="Element5">
File System Read/Write</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
The synchronous, file system style, read/write data transfer model is intended to be similar to the POSIX read and write (and fread and fwrite) operations, as shown in the following example.&nbsp;</p>
<p class="Element10">
<strong>Example: Reading Data Using the File System Style Model</strong> &nbsp;</p><div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code00139');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00139"><pre class="Element12"><strong><span style="color: #000080">char</span></strong>    buffer[MY_BUFFER_SIZE];
size_t  count;

count = DRV_USART_Read(myUsart, buffer, MY_BUFFER_SIZE);</pre></div></div>
<p class="Element10">
In the previous data read example, the single <a href="11506.html">DRV_USART_Read</a> function is called to transfer the entire contents of the <span class="Element146">buffer</span> array. In a RTOS or file system model environment (described as follows), this function should not return until all data has been transferred or some form of error or time-out occurs. The success of this operation will be indicated by the return value stored in the <span class="Element146">count</span> variable. If it is equal to the value of MY_BUFFER_SIZE, the operation completed successfully.&nbsp;</p>
<p class="Element10">
<strong>Example: Writing Data Using the File System Style Model</strong> &nbsp;</p><div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code00140');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00140"><pre class="Element12"><strong><span style="color: #000080">char</span></strong>    buffer = “Hello World\n”;
size_t  count;

count = DRV_USART_Write(myUsart, buffer, strlen(buffer));</pre></div></div>
<p class="Element10">
In the previous data write example, the single <a href="11520.html">DRV_USART_Write</a> function is called to transfer the entire contents of the buffer string. Like the data reading example, in a RTOS or file system model environment, this function should not return until all data has been transferred or some form of error or time-out occurs. The success of this operation is indicated by the return value stored in the <span class="Element146">count</span> variable. If its value is equal to <span class="Element146">strlen(buffer)</span>, the operation completed successfully.&nbsp;</p>
<p class="Element10">
For simple data stream peripherals, such as UART, SPI, I2S, etc., this is normally the most basic data transfer model that a driver should support. It has the advantage that it provides a simple single-function interface and, depending on the configuration and execution environment, it manages advancing through the caller’s buffer automatically and does not return until all data has been transferred.&nbsp;</p>
<p class="Element10">
If an error occurs, most drivers will return (<span class="Element146">(size_t)-1</span>) (equivalent to a maximum unsigned integer value) from these functions. Or, in a non-blocking environment, they will only transfer the amount of data that can be buffered by the driver or hardware. So, this data transfer model has the disadvantage that the caller should always check the return count and may need to call a driver-specific status function to identify if an error has occurred. If no error has occurred, the caller may need to call the function again (potentially several times) to complete the desired transfer. So, this model is most suitable for configurations that provide sufficient buffering or that support a RTOS or where blocking behavior is acceptable, such as a file system model environment where operation of other modules is not required.</p></div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="13064.html">Volume IV: MPLAB Harmony Development</a> &gt; <a href="16810.html">MPLAB Harmony Driver Development Guide</a> &gt; <a href="11772.html">Client Interface</a> &gt; <a href="11774.html">Common Data Transfer Models</a> &gt; <a href="11779.html">File System Read/Write</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
 MPLAB Harmony Help</div>
</td></tr><tr><td width="100%">
<div class="Element4">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td></tr><tr><td width="100%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: DRVDEVGUIDE File System Read_Write Topic Title: File System Read/Write)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>