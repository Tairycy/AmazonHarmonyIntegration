<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>System Access</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta name="save" content="history" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoad();" onmousedown="onBodyMouseDown();">
<div id="persistenceDiv" style="display:none; behavior:url(#default#userData);"></div>

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="13069.html">Driver Libraries Help</a> &gt; <a href="13729.html">I2C Driver Library Help</a> &gt; <a href="08593.html">Using the Library</a> &gt; <a href="08585.html">How the Library Works</a> &gt; <a href="08591.html">System Access</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony Help</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="08585.html">Previous</a> | <a href="08585.html">Up</a> | <a href="08578.html">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: DRV I2C System Access Topic Title: System Access)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table><div class="Element5">
System Access</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<div class="Element15">
System Access</div>
<p class="Element10">
The system performs the initialization of the device driver with settings that affect only the instance of the device that is being initialized. During system initialization, each instance of the I2C module would be initialized with the following configuration settings (either passed dynamically at run-time using DRV_I2C_INIT or by using initialization overrides) that are supported by the specific I2C device hardware:
<ul class="Element635">
<li class="Element605">Device requested power state: one of the System Module Power States. For specific details please refer to <strong>Data Types and Constants</strong> in the <a href="08587.html">Library Interface</a> section.</li>
<li class="Element605">The actual peripheral ID enumerated as the PLIB level module ID (e.g., I2C_ID_2)</li>
<li class="Element605">Master or Slave mode of operation and their associated parameters</li>
<li class="Element605">Defining the respective interrupt sources for Master, Slave, and Error Interrupt</li>
</ul>The <a href="10111.html">DRV_I2C_Initialize</a> API returns an object handle of the type <a href="23975.html">SYS_MODULE_OBJ</a>. After this, the object handle returned by the Initialize interface would be used by the other system interfaces like <a href="10108.html">DRV_I2C_Deinitialize</a>, <a href="10119.html">DRV_I2C_Status</a>, and <a href="10120.html">DRV_I2C_Tasks</a>. </p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table0">
<tr>
<td class="Element67" valign="top" width="10%" style="border:none;">
<div class="Element68">
<img src="Note Icon.png" border="0" alt="" title=""> <strong>Note:</strong>&nbsp;</div></td><td class="Element67" valign="top" width="90%" style="border:none;">
<div class="Element68">
The system initialization settings, only affect the instance of the peripheral that is being initialized.&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
<strong>Example:</strong> </p><div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code00626');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00626"><pre class="Element12">DRV_I2C_INIT        i2c_init_data;
SYS_MODULE_OBJ      objectHandle;

i2c_init_data.i2cId = DRV_I2C_PERIPHERAL_ID_IDX0,
i2c_init_data.i2cMode = DRV_I2C_MODE_MASTER,
OR
i2c_init_data.i2cMode = DRV_I2C_MODE_SLAVE,

<i><span style="color: #008000">/*    Master mode parameters */</span></i>
i2c_init_data.baudRate = 100000,
i2c_init_data.busspeed = DRV_I2C_SLEW_RATE_CONTROL_IDX0,
i2c_init_data.buslevel = DRV_I2C_SMBus_SPECIFICATION_IDX0,

<i><span style="color: #008000">/*    Master mode parameters */</span></i>
i2c_init_data.addWidth = DRV_I2C_7BIT_SLAVE,
i2c_init_data.reservedaddenable  = <strong><span style="color: #000080">false</span></strong>,
i2c_init_data.generalcalladdress = <strong><span style="color: #000080">false</span></strong>,
i2c_init_data.slaveaddvalue = 0x0060,

<i><span style="color: #008000">//interrupt sources</span></i>
i2c_init_data.mstrInterruptSource = INT_SOURCE_I2C_2_MASTER,
i2c_init_data.slaveInterruptSource = INT_SOURCE_I2C_2_ERROR,
i2c_init_data.errInterruptSource = INT_SOURCE_I2C_2_ERROR,
i2c_init_data.queueSize = 1,

<i><span style="color: #008000">/* callback for Master (Master mode can use callbacks if needed) */</span></i>
i2c_init_data.operationStarting = NULL,

<i><span style="color: #008000">/* Slave mode callbacks needed */</span></i>
i2c_init_data.operationStarting = APP_I2CSlaveFunction,

objectHandle = DRV_I2C_Initialize(DRV_I2C_INDEX_0, (SYS_MODULE_INIT *)&amp;drvI2C0InitData)
<strong><span style="color: #000080">if</span></strong> (SYS_MODULE_OBJ_INVALID == objectHandle)
{
   <i><span style="color: #008000">// Handle error</span></i>
}</pre></div></div>
<p class="Element10">
Since the I2C bus is controlled by the Master, the Slave should respond to a read or write request whenever the Master makes the request. Thus, the slave does not have driver states like the Master. The operation of the I2C Driver when used in Slave mode is handled using callbacks. The callback, OperationStarting, must be configured during system initialization when in Slave mode. This callback is provided so that the application can respond appropriately when a read or write request is received from the Master.</p></div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="13069.html">Driver Libraries Help</a> &gt; <a href="13729.html">I2C Driver Library Help</a> &gt; <a href="08593.html">Using the Library</a> &gt; <a href="08585.html">How the Library Works</a> &gt; <a href="08591.html">System Access</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
 MPLAB Harmony Help</div>
</td></tr><tr><td width="100%">
<div class="Element4">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td></tr><tr><td width="100%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: DRV I2C System Access Topic Title: System Access)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>