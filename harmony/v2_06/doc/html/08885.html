<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>System Interaction</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta name="save" content="history" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoad();" onmousedown="onBodyMouseDown();">
<div id="persistenceDiv" style="display:none; behavior:url(#default#userData);"></div>

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="13069.html">Driver Libraries Help</a> &gt; <a href="08887.html">Timer Driver Library</a> &gt; <a href="08888.html">Using the Library</a> &gt; <a href="08878.html">How the Library Works</a> &gt; <a href="08885.html">System Interaction</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony Help</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="08878.html">Previous</a> | <a href="08878.html">Up</a> | <a href="08869.html">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: DRV TMR System Interaction Topic Title: System Interaction)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table><div class="Element5">
System Interaction</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<div class="Element15">
Initialization and Reinitialization</div>
<p class="Element10" style="text-align: justify;">
The system performs the initialization of the device driver with settings that affect only the instance of the device that is being initialized.</p><p class="Element10">
The <a href="11297.html">DRV_TMR_Initialize</a> function returns an object handle of the type <a href="23975.html">SYS_MODULE_OBJ</a>. After this, the object handle returned by the Initialize interface would be used by the other system interfaces such as <a href="11268.html">DRV_TMR_Deinitialize</a> and <a href="11312.html">DRV_TMR_Status</a>, <a href="11314.html">DRV_TMR_Tasks</a>.&nbsp;</p>
<p class="Element10">
<strong>Example: Timer Initialization</strong> &nbsp;</p><div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code00902');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00902"><pre class="Element12">DRV_TMR_INIT     init;
SYS_MODULE_OBJ   object;
SYS_STATUS       tmrStatus;

<i><span style="color: #008000">// populate the TMR init configuration structure</span></i>
init.moduleInit.value = SYS_MODULE_POWER_RUN_FULL;
init.tmrId            = TMR_ID_2;
init.clockSource      = TMR_CLOCK_SOURCE_PERIPHERAL_CLOCK;
init.prescale         = TMR_PRESCALE_VALUE_256;
init.interruptSource  = INT_SOURCE_TIMER_2;
init.mode             = DRV_TMR_OPERATION_MODE_16_BIT;
init.asyncWriteEnable = <strong><span style="color: #000080">false</span></strong>;

object = DRV_TMR_Initialize (DRV_TMR_INDEX_0, (SYS_MODULE_INIT *)&amp;init);

<strong><span style="color: #000080">if</span></strong> (object == SYS_MODULE_OBJ_INVALID)
{
    <i><span style="color: #008000">// Handle error</span></i>
}</pre></div></div>
<div class="Element15">
Deinitialization</div>
<p class="Element10">
Once the Initialize operation has been called, the Deinitialize operation must be called before the Initialize operation can be called again. This routine may block if the driver is running in an OS environment that supports blocking operations and the driver requires system resources access. However, the routine will never block for hardware Timer access.</p><div class="Element15">
Status</div>
<p class="Element10">
Timer status is available to query the module state after initialization and reinitialization.</p><div class="Element15">
Tasks Routine</div>
<p class="Element10">
The interface <a href="11314.html">DRV_TMR_Tasks</a> needs to be called by the system task service in a polled environment and in an interrupt-based system.&nbsp;</p>
<p class="Element10">
<strong>Example: Polling</strong> &nbsp;</p><div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code00903');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00903"><pre class="Element12"><strong><span style="color: #000080">int</span></strong> main( <strong><span style="color: #000080">void</span></strong> )
{
    SYS_MODULE_OBJ object;
    object = DRV_TMR_Initialize( DRV_TMR_INDEX_0, (SYS_MODULE_INIT *) &amp;initConf );

    <strong><span style="color: #000080">if</span></strong>( SYS_STATUS_READY != DRV_TMR_Status( object ) )
        <strong><span style="color: #000080">return</span></strong> 0;

    <strong><span style="color: #000080">while</span></strong> (1)
    {
        DRV_TMR_Tasks (object);
    }
}</pre></div></div>
<p class="Element10">
<strong>Example: Interrupt</strong> </p><div class="Element170">
<a href="#" onclick="CopyElementToClipboard('code00904');">Copy Code</a></div>
<div class="Element13"><div class="Element12" id="code00904"><pre class="Element12"><strong><span style="color: #000080">int</span></strong> main( <strong><span style="color: #000080">void</span></strong> )
{
    SYS_MODULE_OBJ object;
    object = DRV_TMR_Initialize( DRV_TMR_INDEX_0, (SYS_MODULE_INIT *) &amp;initConf );

    <strong><span style="color: #000080">if</span></strong>( SYS_STATUS_READY != DRV_TMR_Status( object ) )
        <strong><span style="color: #000080">return</span></strong> 0;

    <strong><span style="color: #000080">while</span></strong> (1);
}

<i><span style="color: #008000">/* Sample interrupt routine not specific to any device family */</span></i>
<strong><span style="color: #000080">void</span></strong> ISR T1Interrupt(<strong><span style="color: #000080">void</span></strong>)
{
    <i><span style="color: #008000">//Call the Timer Tasks routine</span></i>
    DRV_TMR_Tasks(object);
}</pre></div></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="16811.html">Volume V: MPLAB Harmony Framework Reference</a> &gt; <a href="13069.html">Driver Libraries Help</a> &gt; <a href="08887.html">Timer Driver Library</a> &gt; <a href="08888.html">Using the Library</a> &gt; <a href="08878.html">How the Library Works</a> &gt; <a href="08885.html">System Interaction</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="100%">
<div class="Element3">
 MPLAB Harmony Help</div>
</td></tr><tr><td width="100%">
<div class="Element4">
<a href="contents.htm">Contents</a> | <a href="idx.html">Index</a> | <a href="04300.html">Home</a></div>
</td></tr><tr><td width="100%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: DRV TMR System Interaction Topic Title: System Interaction)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>